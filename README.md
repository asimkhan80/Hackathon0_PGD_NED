# Digital FTE Cognitive Loop Core

<div align="center">

```
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                                                              â•‘
    â•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—             â•‘
    â•‘     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘             â•‘
    â•‘     â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘             â•‘
    â•‘     â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘             â•‘
    â•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—        â•‘
    â•‘     â•šâ•â•â•â•â•â• â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â•   â•šâ•â•   â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•        â•‘
    â•‘                                                              â•‘
    â•‘              â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—                       â•‘
    â•‘              â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•                       â•‘
    â•‘              â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—                         â•‘
    â•‘              â–ˆâ–ˆâ•”â•â•â•     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â•                         â•‘
    â•‘              â–ˆâ–ˆâ•‘        â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—                       â•‘
    â•‘              â•šâ•â•        â•šâ•â•   â•šâ•â•â•â•â•â•â•                       â•‘
    â•‘                                                              â•‘
    â•‘         ğŸ§  Cognitive Loop Core v0.1.0                        â•‘
    â•‘         File-based Autonomous Agent Infrastructure          â•‘
    â•‘                                                              â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

[![Node.js](https://img.shields.io/badge/Node.js-20+-339933?style=for-the-badge&logo=nodedotjs&logoColor=white)](https://nodejs.org/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.9-3178C6?style=for-the-badge&logo=typescript&logoColor=white)](https://www.typescriptlang.org/)
[![XState](https://img.shields.io/badge/XState-5.25-2C3E50?style=for-the-badge&logo=xstate&logoColor=white)](https://xstate.js.org/)
[![License](https://img.shields.io/badge/License-MIT-yellow?style=for-the-badge)](LICENSE)

**An intelligent, file-based autonomous agent that processes tasks through an 8-state cognitive loop**

[Features](#-features) â€¢ [Installation](#-installation) â€¢ [Quick Start](#-quick-start) â€¢ [Demo](#-demo) â€¢ [Architecture](#-architecture) â€¢ [Commands](#-cli-commands)

</div>

---

## Overview

Digital FTE (Full-Time Employee) Core is a **hackathon project** that implements an autonomous task processing system using a cognitive loop architecture. It watches for task files in an Obsidian-style vault, processes them through 8 distinct cognitive states, and produces audited, logged results.

Think of it as a **digital worker** that:
- Monitors for new tasks
- Plans how to execute them
- Requests human approval when needed
- Executes the plan
- Logs everything for audit

---

## Cognitive Loop

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ğŸ§  THE COGNITIVE LOOP                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚    â”‚  WATCH  â”‚â”€â”€â”€â”€â–¶â”‚  WRITE  â”‚â”€â”€â”€â”€â–¶â”‚  REASON  â”‚â”€â”€â”€â”€â–¶â”‚  PLAN   â”‚            â”‚
â”‚    â”‚   ğŸ‘ï¸    â”‚     â”‚   âœï¸    â”‚     â”‚   ğŸ¤”     â”‚     â”‚   ğŸ“‹    â”‚            â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜            â”‚
â”‚         â”‚                                                 â”‚                 â”‚
â”‚         â”‚              8-STATE COGNITIVE LOOP             â”‚                 â”‚
â”‚         â”‚                                                 â–¼                 â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚    â”‚  CLOSE  â”‚â—€â”€â”€â”€â”€â”‚   LOG   â”‚â—€â”€â”€â”€â”€â”‚   ACT    â”‚â—€â”€â”€â”€â”€â”‚ APPROVE â”‚            â”‚
â”‚    â”‚   âœ…    â”‚     â”‚   ğŸ“    â”‚     â”‚   âš¡     â”‚     â”‚   âœ‹    â”‚            â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STATE       â”‚ DESCRIPTION                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ‘ï¸  WATCH   â”‚ Monitor inbox for new task files                           â”‚
â”‚ âœï¸  WRITE   â”‚ Parse and validate task frontmatter                        â”‚
â”‚ ğŸ¤” REASON   â”‚ Analyze task, determine requirements                       â”‚
â”‚ ğŸ“‹ PLAN     â”‚ Generate execution plan with approval detection            â”‚
â”‚ âœ‹ APPROVE  â”‚ Wait for human approval (if required)                      â”‚
â”‚ âš¡ ACT      â”‚ Execute the plan steps                                      â”‚
â”‚ ğŸ“ LOG      â”‚ Record audit entry with checksums                          â”‚
â”‚ âœ… CLOSE    â”‚ Move to completed folder, update status                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Features

| Feature | Description |
|---------|-------------|
| **8-State Cognitive Loop** | Tasks flow through WATCH â†’ WRITE â†’ REASON â†’ PLAN â†’ APPROVE â†’ ACT â†’ LOG â†’ CLOSE |
| **XState v5 State Machine** | Robust, predictable state transitions with event-driven architecture |
| **File-Based Workflow** | Uses markdown files with YAML frontmatter - works with Obsidian |
| **Human-in-the-Loop** | Automatic approval detection for sensitive operations (financial, etc.) |
| **Immutable Audit Trail** | SHA-256 checksums for every audit entry, tamper-evident logging |
| **Real-Time File Watching** | Chokidar-powered file system monitoring |
| **File Locking** | Prevents race conditions with proper-lockfile |
| **PM2 Integration** | Production-ready process management |

---

## Tech Stack

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      TECHNOLOGY STACK                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚   Runtime        â”‚  Node.js 20+                                â”‚
â”‚   Language       â”‚  TypeScript 5.9                             â”‚
â”‚   State Machine  â”‚  XState v5.25                               â”‚
â”‚   CLI Framework  â”‚  Commander.js 12                            â”‚
â”‚   File Watching  â”‚  Chokidar 3.6                               â”‚
â”‚   YAML Parsing   â”‚  Gray-matter 4                              â”‚
â”‚   Logging        â”‚  Pino 9                                     â”‚
â”‚   File Locking   â”‚  proper-lockfile 4                          â”‚
â”‚   Process Mgmt   â”‚  PM2                                        â”‚
â”‚   Testing        â”‚  Vitest 2                                   â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Installation

### Prerequisites

- **Node.js 20+** ([Download](https://nodejs.org/))
- **npm** (comes with Node.js)
- **Git** ([Download](https://git-scm.com/))

### Quick Install

```bash
# Clone the repository
git clone https://github.com/asimkhan80/Hackathon0_PGD_NED.git

# Navigate to project directory
cd Hackathon0_PGD_NED

# Install dependencies
npm install

# Build the project
npm run build
```

### Verify Installation

```bash
# Check TypeScript compilation
npm run typecheck

# Run tests
npm test
```

---

## Quick Start

### Step 1: Initialize the Vault

```bash
# Create vault directory structure
npm run vault:init

# Or with custom path
npm run vault:init -- --path ./my-vault
```

This creates:

```
vault/
â”œâ”€â”€ inbox/          # Drop new tasks here
â”œâ”€â”€ active/         # Tasks being processed
â”œâ”€â”€ plans/
â”‚   â”œâ”€â”€ pending/    # Plans awaiting approval
â”‚   â”œâ”€â”€ approved/   # Approved plans
â”‚   â””â”€â”€ rejected/   # Rejected plans
â”œâ”€â”€ completed/      # Finished tasks
â”œâ”€â”€ logs/           # Audit logs
â””â”€â”€ errors/         # Error reports
```

### Step 2: Start the Cognitive Loop

```bash
# Start in foreground (see logs in terminal)
npm run start -- --foreground

# Or start as daemon with PM2
npm run start:pm2
```

### Step 3: Create a Task

Drop a markdown file in `vault/inbox/`:

```bash
# Example: vault/inbox/test-task.md
```

```markdown
---
id: task-001
title: Process quarterly report
source: manual
priority: high
state: WATCH
created: 2024-01-18T10:00:00Z
---

# Task: Process Quarterly Report

## Description
Analyze and summarize the quarterly financial report.

## Requirements
- [ ] Extract key metrics
- [ ] Calculate growth rates
- [ ] Generate summary
```

### Step 4: Watch It Process

The cognitive loop will automatically:
1. Detect the new file (WATCH)
2. Parse and validate (WRITE)
3. Analyze requirements (REASON)
4. Generate a plan (PLAN)
5. Wait for approval if needed (APPROVE)
6. Execute the plan (ACT)
7. Log the audit trail (LOG)
8. Move to completed (CLOSE)

---

## Demo

### Full Demo Walkthrough

```bash
# Terminal 1: Start the cognitive loop
npm run start -- --foreground --log-level debug

# Terminal 2: Create a test task
mkdir -p vault/inbox

cat > vault/inbox/demo-task.md << 'EOF'
---
id: demo-001
title: Demo Task - Hello World
source: manual
priority: normal
state: WATCH
created: 2024-01-18T12:00:00Z
---

# Demo Task

This is a demonstration of the cognitive loop.

## Steps
- [ ] Process this task
- [ ] Generate output
EOF

# Watch Terminal 1 for processing logs!
```

### Check Status

```bash
# View vault status
npm run vault:status

# Detailed statistics
npm run vault:status -- --detailed

# JSON output
npm run vault:status -- --json
```

### Financial Task (Requires Approval)

```bash
cat > vault/inbox/financial-task.md << 'EOF'
---
id: fin-001
title: Process $5000 payment
source: finance
priority: urgent
state: WATCH
created: 2024-01-18T12:00:00Z
---

# Financial Task

Process payment of $5000 to vendor.

## Details
- Amount: $5000
- Vendor: ACME Corp
EOF
```

This task will pause at APPROVE state until you move the plan from `vault/plans/pending/` to `vault/plans/approved/`.

---

## CLI Commands

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           CLI COMMANDS                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  digital-fte init [options]                                             â”‚
â”‚  â”œâ”€â”€ -p, --path <path>    Vault path (overrides VAULT_PATH env)        â”‚
â”‚  â””â”€â”€ -q, --quiet          Minimal output                                â”‚
â”‚                                                                         â”‚
â”‚  digital-fte status [options]                                           â”‚
â”‚  â”œâ”€â”€ -p, --path <path>    Vault path                                   â”‚
â”‚  â”œâ”€â”€ -d, --detailed       Show detailed statistics                     â”‚
â”‚  â””â”€â”€ -j, --json           Output as JSON                                â”‚
â”‚                                                                         â”‚
â”‚  digital-fte start [options]                                            â”‚
â”‚  â”œâ”€â”€ -p, --path <path>    Vault path                                   â”‚
â”‚  â”œâ”€â”€ -l, --log-level      Log level (debug, info, warn, error)         â”‚
â”‚  â””â”€â”€ -f, --foreground     Run in foreground                            â”‚
â”‚                                                                         â”‚
â”‚  digital-fte stop [options]                                             â”‚
â”‚  â”œâ”€â”€ -f, --force          Force stop (no graceful shutdown)            â”‚
â”‚  â””â”€â”€ -n, --name <name>    PM2 process name                             â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### NPM Scripts

| Script | Description |
|--------|-------------|
| `npm run build` | Compile TypeScript to JavaScript |
| `npm run start` | Start cognitive loop (tsx) |
| `npm run start:pm2` | Start as PM2 daemon |
| `npm run stop` | Stop PM2 daemon |
| `npm run vault:init` | Initialize vault structure |
| `npm run vault:status` | Show vault status |
| `npm test` | Run tests with Vitest |
| `npm run typecheck` | TypeScript type checking |

---

## Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           SYSTEM ARCHITECTURE                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                        â”‚
â”‚  â”‚   CLI Layer     â”‚  Commander.js commands (init, start, status, stop)    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                        â”‚
â”‚           â”‚                                                                 â”‚
â”‚           â–¼                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                        â”‚
â”‚  â”‚  Cognitive Loop â”‚  XState v5 state machine + Chokidar watcher           â”‚
â”‚  â”‚    Processor    â”‚                                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                        â”‚
â”‚           â”‚                                                                 â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚     â”‚                                               â”‚                       â”‚
â”‚     â–¼                                               â–¼                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  Task Module    â”‚                       â”‚  Plan Module    â”‚              â”‚
â”‚  â”‚  - create       â”‚                       â”‚  - generate     â”‚              â”‚
â”‚  â”‚  - read         â”‚                       â”‚  - validate     â”‚              â”‚
â”‚  â”‚  - transition   â”‚                       â”‚  - approval     â”‚              â”‚
â”‚  â”‚  - complete     â”‚                       â”‚  - update       â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚           â”‚                                         â”‚                       â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                              â”‚                                              â”‚
â”‚                              â–¼                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         Core Libraries                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ markdown â”‚ â”‚ filelock â”‚ â”‚ checksum â”‚ â”‚  errors  â”‚ â”‚  config   â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                              â”‚
â”‚                              â–¼                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        Vault (File System)                           â”‚   â”‚
â”‚  â”‚  inbox/ â”‚ active/ â”‚ plans/ â”‚ completed/ â”‚ logs/ â”‚ errors/           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Directory Structure

```
src/
â”œâ”€â”€ cli/
â”‚   â”œâ”€â”€ index.ts              # CLI entry point
â”‚   â””â”€â”€ commands/
â”‚       â”œâ”€â”€ init.ts           # vault:init command
â”‚       â”œâ”€â”€ start.ts          # start command
â”‚       â”œâ”€â”€ status.ts         # status command
â”‚       â””â”€â”€ stop.ts           # stop command
â”œâ”€â”€ config.ts                 # Configuration loader
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ checksum.ts           # SHA-256 checksums
â”‚   â”œâ”€â”€ errors.ts             # Custom error classes
â”‚   â”œâ”€â”€ filelock.ts           # File locking utilities
â”‚   â””â”€â”€ markdown.ts           # Frontmatter parsing
â”œâ”€â”€ modules/
â”‚   â”œâ”€â”€ audit/
â”‚   â”‚   â”œâ”€â”€ log.ts            # Audit logging
â”‚   â”‚   â”œâ”€â”€ query.ts          # Query audit entries
â”‚   â”‚   â””â”€â”€ verify.ts         # Verify audit integrity
â”‚   â”œâ”€â”€ error/
â”‚   â”‚   â””â”€â”€ report.ts         # Error reporting
â”‚   â”œâ”€â”€ loop/
â”‚   â”‚   â”œâ”€â”€ index.ts          # Loop exports
â”‚   â”‚   â”œâ”€â”€ machine.ts        # XState state machine
â”‚   â”‚   â”œâ”€â”€ processor.ts      # Task processor
â”‚   â”‚   â””â”€â”€ watcher.ts        # File watcher
â”‚   â”œâ”€â”€ plan/
â”‚   â”‚   â”œâ”€â”€ approval.ts       # Approval workflow
â”‚   â”‚   â”œâ”€â”€ generate.ts       # Plan generation
â”‚   â”‚   â”œâ”€â”€ read.ts           # Plan reading
â”‚   â”‚   â”œâ”€â”€ update.ts         # Plan updating
â”‚   â”‚   â””â”€â”€ validate.ts       # Plan validation
â”‚   â”œâ”€â”€ task/
â”‚   â”‚   â”œâ”€â”€ approval.ts       # Task approval
â”‚   â”‚   â”œâ”€â”€ complete.ts       # Task completion
â”‚   â”‚   â”œâ”€â”€ create.ts         # Task creation
â”‚   â”‚   â”œâ”€â”€ read.ts           # Task reading
â”‚   â”‚   â””â”€â”€ transition.ts     # State transitions
â”‚   â””â”€â”€ vault/
â”‚       â”œâ”€â”€ init.ts           # Vault initialization
â”‚       â”œâ”€â”€ status.ts         # Vault status
â”‚       â””â”€â”€ verify.ts         # Vault verification
â””â”€â”€ types/
    â”œâ”€â”€ audit.ts              # Audit types
    â”œâ”€â”€ config.ts             # Config types
    â”œâ”€â”€ enums.ts              # Enums (TaskState, etc.)
    â”œâ”€â”€ error.ts              # Error types
    â”œâ”€â”€ plan.ts               # Plan types
    â””â”€â”€ task.ts               # Task types
```

---

## Configuration

### Environment Variables

| Variable | Description | Default |
|----------|-------------|---------|
| `VAULT_PATH` | Path to vault directory | `./vault` |
| `LOG_LEVEL` | Logging level | `info` |
| `WATCH_INTERVAL` | File watch interval (ms) | `1000` |

### Example .env

```bash
VAULT_PATH=./vault
LOG_LEVEL=debug
WATCH_INTERVAL=500
```

---

## Task File Format

Tasks use YAML frontmatter in markdown files:

```markdown
---
id: unique-task-id
title: Task Title
source: manual | gmail | whatsapp | filesystem | finance
priority: low | normal | high | urgent
state: WATCH
created: 2024-01-18T12:00:00Z
updated: 2024-01-18T12:00:00Z
tags:
  - tag1
  - tag2
---

# Task Content

Description and details go here.

## Checklist
- [ ] Step 1
- [ ] Step 2
- [ ] Step 3
```

---

## Approval Workflow

Tasks containing sensitive keywords automatically require human approval:

### Trigger Keywords
- `$` (currency)
- `payment`, `transfer`, `invoice`
- `budget`, `financial`
- `delete`, `remove`
- `admin`, `root`, `sudo`

### Approval Process

1. Task reaches PLAN state
2. System detects approval keywords
3. Plan saved to `vault/plans/pending/`
4. System waits at APPROVE state
5. Human moves file to `vault/plans/approved/` or `vault/plans/rejected/`
6. System continues (ACT) or fails (reject)

---

## Testing

```bash
# Run all tests
npm test

# Run tests once (CI mode)
npm run test:run

# Watch mode
npm test -- --watch

# With coverage
npm test -- --coverage
```

---

## Development

```bash
# Type checking
npm run typecheck

# Build
npm run build

# Run directly with tsx (no build needed)
npx tsx src/cli/index.ts status
```

---

## Contributing

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

---

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

---

## Acknowledgments

- Built for **PGD NED Hackathon 2024**
- Powered by [XState](https://xstate.js.org/) for robust state management
- Uses [Obsidian](https://obsidian.md/)-compatible markdown format

---

<div align="center">

**Made with by Asim Khan**

```
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                                                              â•‘
    â•‘   "The best way to predict the future is to automate it"    â•‘
    â•‘                                                              â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

</div>
